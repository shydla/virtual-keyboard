!function(){"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var o=r.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}();e.p;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,a,n,c,l=[],i=!0,s=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(o=n.call(r)).done)&&(l.push(o.value),l.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{if(!i&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function a(e,r){for(var o=0;o<r.length;o++){var a=r[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(n=a.key,c=void 0,c=function(e,r){if("object"!==t(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,r||"default");if("object"!==t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(n,"string"),"symbol"===t(c)?c:String(c)),a)}var n,c}function n(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),r}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"getOneRow",value:function(){return n(this,e,i).call(this,[{Backquote:["§","±","ё","Ё"]},{Digit1:["1","!","1","!"]},{Digit2:["2","@","2",'"']},{Digit3:["3","#","3","№"]},{Digit4:["4","$","4",";"]},{Digit5:["5","%","5","%"]},{Digit6:["6","^","6",":"]},{Digit7:["7","&","7","?"]},{Digit8:["8","*","8","*"]},{Digit9:["9","(","9","("]},{Digit0:["0",")","0",")"]},{Minis:["-","_","-","_"]},{Equal:["=","+","=","+"]},"Backspace"],"one")}},{key:"getTwoRow",value:function(){return n(this,e,i).call(this,["Tab",{KeyQ:["q","Q","й","Й"]},{KeyW:["w","W","ц","Ц"]},{KeyE:["e","E","у","У"]},{KeyR:["r","R","к","К"]},{KeyT:["t","T","е","Е"]},{KeyY:["y","Y","н","Н"]},{KeyU:["u","U","г","Г"]},{KeyU:["i","I","ш","ш"]},{KeyI:["o","O","щ","Щ"]},{KeyO:["p","P","з","З"]},{BracketLeft:["[","{","х","Х"]},{BracketRight:["]","}","ъ","Ъ"]}],"two")}},{key:"getThreeRow",value:function(){return n(this,e,i).call(this,["CapsLock",{KeyA:["a","A","ф","Ф"]},{KeyS:["s","S","ы","Ы"]},{KeyD:["d","D","в","В"]},{KeyF:["f","F","а","А"]},{KeyG:["g","G","п","П"]},{KeyH:["h","H","р","Р"]},{KeyJ:["j","J","о","О"]},{KeyK:["k","K","л","Л"]},{KeyL:["l","L","д","Д"]},{Semicolon:[";",":","ж","Ж"]},{Quote:["'",'"',"э","Э"]},{Backslash:["\\","|","\\","/"]},"Enter"],"three")}},{key:"getFourRow",value:function(){return n(this,e,i).call(this,["ShiftLeft",{IntlBackslash:["`","~","]","["]},{KeyZ:["z","Z","я","Я"]},{KeyX:["x","X","ч","Ч"]},{KeyC:["c","C","с","С"]},{KeyV:["v","V","м","М"]},{KeyB:["b","B","и","И"]},{KeyN:["n","N","т","Т"]},{KeyM:["m","M","ь","Ь"]},{Comma:[",","<","б","Б"]},{Period:[".",">","ю","Ю"]},{Slash:["/","?",".",","]},"ArrowUp","ShiftRight"],"four")}},{key:"getFiveRow",value:function(){return n(this,e,i).call(this,["ControlLeft","AltLeft","MetaLeft","Space","MetaRight","AltRight","ArrowLeft","ArrowDown","ArrowRight"],"five")}}],(r=null)&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){var r="up";localStorage.getItem("kbShift")&&(r=localStorage.getItem("kbShift"));var o="up";localStorage.getItem("kbCaps")&&(o=localStorage.getItem("kbCaps"));var a=document.createElement("span");a.classList.add("unselectable");var n=0;return"down"===o&&t.startsWith("Key")&&(n+=1),"down"===r&&"down"!==o&&(n+=1),a.innerText=e[n],a}function i(e,t){var o=document.createElement("div");o.classList.add(t),o.classList.add("row");for(var a=0;a<e.length;a+=1){var i=document.createElement("div");if(i.classList.add("key"),"string"!=typeof e[a]){var s=Object.keys(e[a])[0];i.classList.add(s),i.id=s;var d=r(e[a][s],4),u=d[0],f=d[1],p=d[2],g=d[3],h="en";localStorage.getItem("kbLang")?h=localStorage.getItem("kbLang"):localStorage.setItem("kbLang","en"),"en"===h?i.appendChild(n(this,c,l).call(this,[u,f],s)):i.appendChild(n(this,c,l).call(this,[p,g],s)),(s.startsWith("Key")||s.startsWith("Dig")||"BracketLeft"===s||"BracketRight"===s||"Semicolon"===s||"Quote"===s||"Backslash"===s||"Comma"===s||"Period"===s||"Slash"===s||"IntlBackslash"===s)&&i.classList.add("key-spec")}else{i.classList.add(e[a]),i.id=e[a],i.classList.add("unselectable");var y=void 0;switch(e[a]){case"ShiftLeft":"down"===localStorage.getItem("kbShift")&&i.classList.add("active"),y="⇧   ";break;case"ShiftRight":"down"===localStorage.getItem("kbShift")&&i.classList.add("active"),y="     ⇧";break;case"ControlLeft":y="ctrl";break;case"ArrowUp":y="↑";break;case"ArrowLeft":y="←";break;case"ArrowDown":y="↓";break;case"ArrowRight":y="→";break;case"AltLeft":case"AltRight":y="⌥";break;case"MetaLeft":case"MetaRight":y="⌘";break;case"Space":y=" ";break;case"CapsLock":y="⇪","down"===localStorage.getItem("kbCaps")&&i.classList.add("active");break;default:y=""}i.innerText=y||e[a]}o.appendChild(i)}return o}var s=document.createElement("main");s.classList.add("wrapper");var d=document.createElement("h1");d.classList.add("h1"),d.innerText="RSS Виртуальная клавиатура",document.body.appendChild(s),s.appendChild(d);var u=document.createElement("textarea");u.classList.add("textarea"),u.cols=7,u.rows=56,u.spellcheck=!1,s.appendChild(u);var f=document.createElement("div");f.classList.add("keyboard"),f.appendChild(c.getOneRow()),s.appendChild(f),f.appendChild(c.getTwoRow()),s.appendChild(f),f.appendChild(c.getThreeRow()),s.appendChild(f),f.appendChild(c.getFourRow()),s.appendChild(f),f.appendChild(c.getFiveRow()),s.appendChild(f);var p=document.createElement("div");p.classList.add("description");var g=document.createElement("p");g.classList.add("p");var h=document.createElement("p");h.classList.add("p"),g.innerText="Клавиатура создана в MacOS",p.appendChild(g),h.innerText="Переключение раскладки LeftCtrl + LeftAlt",p.appendChild(h),s.appendChild(p);var y=document.querySelector(".textarea");y.focus(),localStorage.setItem("kbAlt","up"),localStorage.setItem("kbCtrl","up"),document.querySelector(".ArrowLeft").addEventListener("mousedown",(function(){return!1}));var m=function(){var e=y.selectionStart,t=y.selectionEnd;e===t&&(console.log(e),e-=1);var r=y.value.split(""),o=r.slice(0,e),a=r.slice(t);y.value=o.join("")+a.join(""),y.selectionStart=e,y.selectionEnd=e},v=function(e){var t=y.selectionStart,r=y.selectionEnd;if("ArrowLeft"===e)if(t!==r)y.selectionEnd=t,y.selectionStart=t;else{var o=t>0?t-1:t;y.selectionStart=o,y.selectionEnd=o}"ArrowRight"===e&&(t!==r?y.selectionStart=r:(y.selectionStart=t>0?t+1:t,y.selectionEnd=t>0?t+1:t))},S=function(e){var t;t="Tab"===e?"   ":"Enter"===e?"\n":"Space"===e?" ":document.querySelector(".".concat(e)).firstChild.innerText;var r=y.selectionEnd,o=y.value.split(""),a=o.slice(0,y.selectionEnd);a.push(t),console.log(a);var n=o.slice(y.selectionEnd);console.log(a.join("")+n.join("")),y.value="",y.value=a.join("")+n.join(""),y.selectionEnd=r+1},k=function(){var e=document.querySelector(".keyboard"),t=document.querySelector(".one");e.replaceChild(c.getOneRow(),t);var r=document.querySelector(".two");e.replaceChild(c.getTwoRow(),r);var o=document.querySelector(".three");e.replaceChild(c.getThreeRow(),o);var a=document.querySelector(".four");e.replaceChild(c.getFourRow(),a)},b=function(e){var t=document.querySelector(".".concat(e.code));t&&(t.classList.add("active"),e.preventDefault(),"ShiftLeft"===e.code||"ShiftRight"===e.code?(localStorage.setItem("kbShift","down"),k(),(t=document.querySelector(".".concat(e.code))).classList.add("active")):"CapsLock"===e.code?(localStorage.setItem("kbCaps","down"),k()):"ControlLeft"===e.code||("Backspace"===e.code?(e.preventDefault(),m()):"AltLeft"===e.code||("ArrowLeft"===e.code||"ArrowRight"===e.code?(e.preventDefault(),v(e.code)):"ArrowUp"===e.code||"ArrowDown"===e.code?(e.preventDefault(),function(e){var t=[],r=[],o=y.value.split("");o.forEach((function(e){"\n"!==e?t.push(e):(t.push("\n"),r.push(t),t=[])})),"\n"!==o[o.length-1]&&r.push(t);for(var a=0,n=0;a<y.selectionEnd;)a+=r[n].length,n+=1;for(var c=y.selectionEnd,l=0;l<n-1;l+=1)c-=r[l].length;var i=0;if("ArrowUp"===e){for(var s=0;s<n-2;s+=1)i+=r[s].length;n>=2&&(r[n-2].length<c?i+=r[n-2].length-1:i+=c,y.selectionEnd=i,y.selectionStart=i)}else{for(var d=0;d<=n-1;d+=1)i+=r[d].length;n-1<r.length-1&&(r[n-1].length<c?i+=r[n].length-1:i+=c,y.selectionEnd=i,y.selectionStart=i)}}(e.code)):S(e.code))))},w=function(e){var t=document.querySelector(".".concat(e.code));t&&(t.classList.remove("active"),"ShiftLeft"===e.code||"ShiftRight"===e.code?(localStorage.setItem("kbShift","up"),k(),(t=document.querySelector(".".concat(e.code))).classList.remove("active")):"CapsLock"===e.code?(localStorage.setItem("kbCaps","up"),k()):"AltLeft"===e.code&&e.ctrlKey||"ControlLeft"===e.code&&e.altKey?(localStorage.setItem("kbLang","en"===localStorage.getItem("kbLang")?"ru":"en"),k()):e.code)};document.addEventListener("keydown",b),document.addEventListener("keyup",w),window.addEventListener("click",(function(e){if(y.focus(),e.target.closest(".key")){if("CapsLock"===e.target.closest(".key").id&&("up"===localStorage.getItem("kbCaps")?(b({code:"CapsLock"}),localStorage.setItem("kbCaps","down")):(w({code:"CapsLock"}),localStorage.setItem("kbCaps","up"))),"ShiftLeft"===e.target.closest(".key").id&&("up"===localStorage.getItem("kbShift")?b({code:"ShiftLeft"}):w({code:"ShiftLeft"})),"ShiftRight"===e.target.closest(".key").id&&("up"===localStorage.getItem("kbShift")?b({code:"ShiftRight"}):w({code:"ShiftRight"})),"Backspace"===e.target.closest(".key").id&&m(),"ControlLeft"===e.target.closest(".key").id&&(localStorage.getItem("kbCtrl")||localStorage.setItem("kbCtrl","up"),"up"===localStorage.getItem("kbCtrl")?(b({code:"ControlLeft"}),localStorage.setItem("kbCtrl","down")):(w({code:"ControlLeft"}),localStorage.setItem("kbCtrl","up"))),"AltLeft"===e.target.closest(".key").id){var t="down"===localStorage.getItem("kbCtrl");w({code:"AltLeft",ctrlKey:t})}"ArrowLeft"!==e.target.closest(".key").id&&"ArrowRight"!==e.target.closest(".key").id||v(e.target.closest(".key").id),S(e.target.closest(".key").id),y.focus()}}))}();